{template 'common/header'}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="../addons/manor_shop/static/css/bootstrap.min.css" media="all" rel="stylesheet" type="text/css"/>
    <link href="../addons/manor_shop/template/mobile/default/static/js/star-rating.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="../addons/manor_shop/template/mobile/default/static/js/star-rating.js" type="text/javascript"></script>
    <script src="../addons/manor_shop/static/js/dist/ajaxfileupload.js" type="text/javascript"></script>

    <title>我有100个柚子送给你</title>
    <style>
       body{background-color:#77aa12; text-align: center;}
       .title1{font-weight: 800;font-size: 2em;margin-top: 20px;}
       .title2{font-weight: 800;font-size: 18px;margin-bottom: 20px;}
       .imgdiv{width:100%; }
       .imgdiv img{width:100%;}
       .input_message {
         background: url(../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/kuangkuang.png) no-repeat;
         background-size: 100%;
         height: 100%;
         margin: 10px;
         width: 94%;
         padding: 10px 4px;
       }
       .exchange{
         background: url(../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/exchange.png) no-repeat;
         background-size: 100%;
         height: 100%;
         margin: 10px;
         width: 94%;
         padding: 46px 40px;
         text-align: left;
       }
       .saythree{

       }
       .show_image{


       }
       .logodiv{width:100%; text-align: center;margin-bottom: 10px;}
       .logodiv img{width:40%;}
       .shareimg{width:100%; text-align: center;margin-bottom: 10px;margin-top: 20px;display:none;}
       .shareimg img{width:40%;}
       .comment_main .line1 {width:100%; height:80px; color:#666; font-size:13px;}
        /*.hdtw{color:#428bca;}*/
        p.inputtitle{font-weight: 800;font-size: 14px; margin:8px;}
        input{width: 100%;height: 33px;background: #ECE6E4;border-radius: 5px; border: 1px solid #77766E;line-height: 30px;font-size: 20px;}
        input::-webkit-input-placeholder, textarea::-webkit-input-placeholder { 
        color: #666; 
        font-weight: 600;font-size: 16px;
        padding-left: 10px;
        } 
        input:-moz-placeholder, textarea:-moz-placeholder { 
        color: #666; 
        font-weight: 600;font-size: 16px;
        padding-left: 10px;
        } 
        input::-moz-placeholder, textarea::-moz-placeholder { 
        color: #666; 
        font-weight: 600;font-size: 16px;
        padding-left: 10px;
        }
       .a-upload {
         height: 100%;
         line-height: 20px;
         position: relative;
         cursor: pointer;
         display: inline-block;
         *display: inline;
         *zoom: 1
       }

       .a-upload  input {
         position: absolute;
         right: 0;
         top: 0;
         opacity: 0;
         filter: alpha(opacity=0);
         cursor: pointer
       }

       .a-upload:hover {
         color: #444;
         background: #eee;
         border-color: #ccc;
         text-decoration: none
       }
       #shareimg{
           display: none;
       }

        input:-ms-input-placeholder, textarea:-ms-input-placeholder { 
        color: #666;
        font-weight: 600;font-size: 16px; 
        padding-left: 10px;
        } 
       .text-left{text-align: left;}
       .text-center{text-align: center;}
       .text-right{text-align: right;}
        #gzborder{ border: 2px dashed #77766E;padding: 5px;border-radius: 8px;}
        #upimgbtn{
            /*height:40px;*/
            line-height: 40px;
            text-align: center;
            color:red;
            background: #ECE6E4;
            border: 2px dashed #77766E;
            margin:15px 0px 15px 0px;
            border-radius: 5px;
            position: relative;
        }
        #sunbtn{    width: 70%;
          height: 50px;
          line-height: 50px;
          font-size: 20px;
          font-weight: 800;
          color: #fff;
          margin: 20px 0px 20px 0px;
        }
        #sharesucc{display:none;}
        #sharesucc a{
          line-height: 60px;
          background: #77A93D;
          font-size: 21px;
          font-weight: 800;
          color: #F3EEEE;
          margin: 10px 0px 10px 0px;
          border-color: #77A93D;
          display: block;
          width: 100%;
          height: 60px;
          border: 1px solid #CCC;
          border-radius:5px;
          text-decoration:none;
        }
        a:link {color: #F3EEEE;} /* 未访问的链接 */
        a:visited {color: #F3EEEE;} /* 已访问的链接 */
        a:hover {color: #F3EEEE;} /* 当有鼠标悬停在链接上 */
        a:active {color: #F3EEEE;} /* 被选择的链接 */
        #sharesucc #title0{font-size: 1.8em;font-weight:600;margin-top:20px;    color: #fff;}
        #sharesucc #title1{font-size: 1.5em;color: #fff;font-weight: 800;}
        #sharesucc #title2{font-size: 1.2em;text-align: left;font-weight: 600;margin-bottom: 50px;}
        .hdtw{color:#428bca;}
        a.hdtw:link {color: #428bca;} /* 未访问的链接 */
        a.hdtw:visited {color: #428bca;} /* 已访问的链接 */
        a.hdtw:hover {color: #428bca;} /* 当有鼠标悬停在链接上 */
        a.hdtw:active {color: #428bca;} /* 被选择的链接 */
    </style>
<div id="sharediv">
  <div class="imgdiv">
    <img  src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/banner.jpg" />
  </div>
  <div class="input_message">
    <p class="text-left inputtitle">亲请输入您的姓名</p>
    <input id="realname"  type="text" value="" placeholder="请输入姓名"/>
    <p class="text-left inputtitle">亲请输入您的手机号码
      <span>(奖品将绑定您的电话号码)</span>
    </p>
    <input id="mobile"  type="text" value="" placeholder="请输入电话号码"/>
    <p class="text-left inputtitle">转发活动并截图上传(分享活动才有机会获得)</p>
    <div id="upimgbtn" data-ogid='0'>
      <div class="plus a-upload">
      <input type="file" name='thumb0' id='thumb0'><img style="width: 100%" src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/upload.png" alt="">
      </div>
    </div>
  </div>
    <div class="show_image">
        <img style="width: 60%;" src="" id="shareimg" alt="">
    </div>
  <img id="sunbtn" src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/submit.png" alt="">
    <div class="text-center">
        <a href=""><img style="width: 100%" src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/exchange1.jpg" alt=""></a>
    </div>
  <div class="text-left saythree" style="padding: 33px">
    <img style="width: 100%;" src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/say_three.png" alt="">
    <img style="width: 80%;margin-left: 10%;margin-top: 20px;" src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/qrcode.jpg" alt="">
  </div>
  <div class="logodiv" style="background-color: #f2ef55 !important;margin-bottom: 0">
    <img  src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/5.png" />
  </div>
</div>
<div id="sharesucc">
    <img onclick="location.href='{php echo $this->createMobileUrl('shop')}'" style="width: 100%;height: 100%;" src="../addons/manor_shop/template/mobile/tangsheng/static/images/youzi/success.jpg" alt="">
</div>
<script language="javascript">
  require(['tpl', 'core'], function(tpl, core) {
    //上传图片方法
    $('.plus input').change(function() {
      //core.loading('正在上传');
      $('#upimgbtn').hide();
      //var comment =$(this).closest('#upimgbtn');
      var ogid = $('#upimgbtn').data('ogid');
      console.log(ogid,'23456789..........');
      $.ajaxFileUpload({
          url: core.getUrl('util/uploader'),
          data: {file: "thumb0"},
          secureuri: false, 
          fileElementId: 'thumb0', 
          dataType: 'json', 
          success: function(res, status) {
              $('#shareimg').attr('src',res.url);
              $('#thumb').val(res.url);
              $('#upimgbtn span').html('重新上传');
              $('#shareimg').show();
              $('#upimgbtn').show();
          }, 
          error: function(data, status, e) {
              console.log(data, status, e);
              $('#upimgbtn').show();
              alert('上传失败，请重新上传！');
          }
      });
    });

    //保存方法，带数据验证
    function saveAddress() {
    if (!$('#realname').val()) {
      alert('请输入姓名!');
      return;
    }
    if(!$('#mobile').val()|| !/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test($('#mobile').val())){
      alert('请输入正确的联系电话!');
      return;
    }
    if($('#shareimg').attr('src')==''){
      alert('请上传分享到朋友圈的截图!');
      return;
    }
    $('#sunbtn').val('正在提交...').attr('disabled', true);
    var posturl = window.location.href;
    $.ajax({
      type: "POST",
      url: posturl,
      data: {
       username:$('#realname').val(), 
       mobile :$('#mobile').val(),
       thumb:$('#shareimg').attr('src'),
       province:$('#sel-provance').val(),
       city:$('#sel-city').val(),
       area:$('#sel-area').val(),
       address:$('#address').val()
      },
      dataType: "json",
      success: function(data){
          if(data.status != 1) {
              alert(data.result);
          } else {
              $('#sunbtn').val('提交成功，跳转中...').attr('disabled', true);
              setTimeout(function () {
                  $('#sharediv').hide();
                  $('#sharesucc').show();
              }, 500);
          }
      },
      error:function(){
        alert('提交失败，请重试！');
        $('#sunbtn').val('提  交').removeAttr('disabled'); 
      }
    });
    }

    //提交按钮绑定事件
    $('#sunbtn').on('click',function(){
      saveAddress();
    })
  });
</script>
{template 'common/footer'}